name: Build and Publish Feed Resources

on:
  schedule:
    - cron: "*/30 * * * *"

jobs:
  build-feeds:
    name: Update latest feed data from source repo
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@2541b1294d2704b0964813337f33b291d3f8596b
      - name: Install Dependencies
        run: yarn
      - name: Checkout Data Source Repo
        uses: actions/checkout@2541b1294d2704b0964813337f33b291d3f8596b
        with:
          repository: smartcontractkit/reference-data-directory
          path: data-source
          token: ${{ secrets.GH_API_KEY }}
      # - name: Read Data Source
      #   run: cat data-source/package.json
      - name: Process Data
        run: yarn process
      - name: Deploy to Firebase
        uses: w9jds/firebase-action@0a5173f97c956332c9e71750526e0ca6f38cbe3a
        with:

          args: -c firebase-addresses.json deploy --only hosting
        env:
          FIREBASE_TOKEN: ${{ secrets.FIREBASE_TOKEN }}
          PROJECT_ID: cl-docs-addresses
